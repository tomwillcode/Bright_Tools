library(dplyr)

#this function takes three arguments 
#data: a dataframe in r
#factor: a factor variable in that dataframe
#features: this is a tuple containing a list of features in the dataframe that you want to standardize
#this function works like scale_by in the "standardize" library, only it scales multiple variables simultaneously


scale_features_by <- function(data, factor, features) {
  standardized_df <- data %>%
    group_by(!!factor) %>%
    summarize_at(vars(all_of(!!features)), list(scale=scale))
  
  return (standardized_df)
}
